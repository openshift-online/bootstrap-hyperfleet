apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: openshift-gitops

resources:
  # Global applications (base cluster infrastructure)
  - ./global/
  - ./clusters/ # cluster-specific ApplicationSets

  # Cluster ApplicationSets
- ../../ocp-789/gitops/

  # Repository configuration for project forks
  - repo-url-patch.yaml

# Override repoURL for project-specific forks
# Update BOOTSTRAP_REPO_URL below to point to your project fork
replacements:
- source:
    kind: ConfigMap
    name: repo-config
    fieldPath: data.repoURL
  targets:
  - select:
      kind: Application
    fieldPaths:
    - spec.source.repoURL
    reject:
    - annotationSelector: external-repo=true  # Skip external repos like Helm charts
  - select:
      kind: ApplicationSet
    fieldPaths: 
    - spec.template.spec.source.repoURL
